<div class="dashboard-container">
  <!-- ============================================
       HEADER PROFESIONAL
       ============================================ -->
  <header class="header">
    <div class="logo">
      <img src="logo.png" alt="NU‚òÖB Logo" class="logo-image">
      <span class="logo-text">NU‚òÖB STUDIO</span>
    </div>
    
    <nav class="nav">
      <a class="nav-link" [class.active]="vistaActual === 'inicio'" (click)="cambiarVista('inicio')">
        Galer√≠a
      </a>
      <a class="nav-link">Artistas</a>
      <a class="nav-link">Blog</a>
      <a class="nav-link" [class.active]="vistaActual === 'seguridad'" (click)="cambiarVista('seguridad')">
        Mi cuenta
      </a>
    </nav>

    <div class="header-actions">
      <button class="icon-btn">üîç</button>
      <button class="icon-btn">üë§</button>
      <button class="icon-btn">‚ù§Ô∏è</button>
      <button class="icon-btn">üõí</button>
      <button (click)="logout()" class="btn-logout">Cerrar sesi√≥n</button>
    </div>
  </header>

  <!-- ‚úÖ BREADCRUMBS (NUEVO) -->
  <app-breadcrumbs [breadcrumbs]="breadcrumbService.getBreadcrumbs()"></app-breadcrumbs>

  <!-- ============================================
       VISTA: GALER√çA DE ARTE (INICIO)
       ============================================ -->
  <main class="content" *ngIf="vistaActual === 'inicio'">
    <!-- Hero Banner -->
    <section class="hero-banner">
      <div class="hero-content">
        <h1 class="hero-title">Arte Regional Huasteco</h1>
        <p class="hero-subtitle">
          Descubre y adquiere obras √∫nicas de artistas talentosos de la Huasteca Hidalguense.
          <br>Cada pieza cuenta una historia, cada creaci√≥n preserva nuestra cultura.
        </p>
        <button class="btn-explore">Explorar Galer√≠a</button>
      </div>
    </section>

    <!-- ============================================
         üèÜ PRODUCTO DESTACADO
         ============================================ -->
    <section class="featured-product-section">
      <div class="section-header">
        <span class="featured-label">‚ú® PIEZA DESTACADA</span>
        <h2>Olla de Barro Artesanal</h2>
        <p>Una pieza tradicional de la Huasteca, elaborada con t√©cnicas ancestrales</p>
      </div>

      <div class="featured-product-container">
        <div class="featured-product-image">
          <img src="OLLA.png" alt="Olla de Barro Artesanal" class="product-main-image">
          <div class="image-badge">Vista 3D disponible</div>
        </div>

        <div class="featured-product-details">
          <div class="product-category-tag">Artesan√≠a / Barro</div>
          <h3 class="product-title">Olla de Barro Huasteca</h3>
          <div class="product-rating">
            <span class="stars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</span>
            <span class="rating-text">(4.8) - 89 rese√±as</span>
          </div>
          <p class="product-description">
            Aut√©ntica olla de barro elaborada a mano por artesanos de la regi√≥n Huasteca. 
            Perfecta para cocinar frijoles, mole y platillos tradicionales que adquieren 
            un sabor √∫nico.
          </p>
          <div class="product-specs">
            <div class="spec-item">
              <span class="spec-icon">üìè</span>
              <span class="spec-text">Capacidad: 3 litros</span>
            </div>
            <div class="spec-item">
              <span class="spec-icon">‚öñÔ∏è</span>
              <span class="spec-text">Peso: 1.5 kg</span>
            </div>
            <div class="spec-item">
              <span class="spec-icon">üî•</span>
              <span class="spec-text">Apta para fuego directo</span>
            </div>
            <div class="spec-item">
              <span class="spec-icon">üì¶</span>
              <span class="spec-text">Env√≠o protegido</span>
            </div>
          </div>
          <div class="product-price-section">
            <span class="price-label">Precio especial:</span>
            <div class="price-container">
              <span class="original-price">$850.00</span>
              <span class="current-price">$650.00</span>
            </div>
            <span class="discount-badge">-24% OFF</span>
          </div>
          <div class="product-actions">
            <button class="btn-buy-now" (click)="comprarProducto()">
              üõí Comprar Ahora
            </button>
            <button class="btn-add-wishlist">
              ‚ù§Ô∏è A√±adir a favoritos
            </button>
          </div>
          <div class="view-3d-section">
            <button class="btn-view-3d" (click)="mostrarQR()">
              <span class="btn-3d-icon">üì±</span>
              <span class="btn-3d-text">Ver en 3D / Realidad Aumentada</span>
            </button>
            <p class="view-3d-hint">Escanea el c√≥digo QR para ver esta pieza en tu espacio</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal QR -->
    <div class="modal-overlay" *ngIf="mostrarModalQR" (click)="cerrarModalQR()">
      <div class="modal-qr" (click)="$event.stopPropagation()">
        <button class="modal-close" (click)="cerrarModalQR()">‚úï</button>
        <div class="modal-header">
          <h3>üì± Ver en 3D / Realidad Aumentada</h3>
          <p>Escanea el c√≥digo QR con tu tel√©fono</p>
        </div>
        <div class="qr-container">
          <img src="qr-jarron-3d.png" alt="C√≥digo QR para ver en 3D" class="qr-image">
        </div>
        <div class="qr-instructions">
          <div class="instruction-step">
            <span class="step-number">1</span>
            <span class="step-text">Abre la c√°mara de tu tel√©fono</span>
          </div>
          <div class="instruction-step">
            <span class="step-number">2</span>
            <span class="step-text">Apunta al c√≥digo QR</span>
          </div>
          <div class="instruction-step">
            <span class="step-number">3</span>
            <span class="step-text">Toca el enlace que aparece</span>
          </div>
          <div class="instruction-step">
            <span class="step-number">4</span>
            <span class="step-text">¬°Visualiza el jarr√≥n en 3D!</span>
          </div>
        </div>
        <a href="https://sketchfab.com/search?q=jarron&type=models" target="_blank" class="btn-open-3d">
          üåê Abrir en navegador
        </a>
      </div>
    </div>

    <!-- ============================================
         üîÄ INVERTIDO: PRIMERO FILTROS, LUEGO T√çTULO
         ============================================ -->
    
        <!-- T√çTULO Y GRID DE OBRAS -->
    <section class="featured-section">
      <!-- ‚úÖ T√çTULO DESPU√âS DE FILTROS -->
      <div class="section-header">
        <h2>{{ categoriaSeleccionada ? 'Obras Filtradas' : 'Galer√≠a de Obras' }}</h2>
        <p *ngIf="!categoriaSeleccionada">Selecci√≥n especial de creaciones que capturan la esencia de nuestra regi√≥n</p>
      </div>


    <!-- FILTROS Y B√öSQUEDA -->
    <section class="filters-section">
      <div class="search-bar">
        <input 
          type="text" 
          placeholder="Buscar por t√≠tulo, artista..." 
          class="search-input"
          [(ngModel)]="terminoBusqueda"
          (keyup.enter)="buscarObras()">
        <button class="search-btn" (click)="buscarObras()">Buscar</button>
      </div>

      <div class="filters">
        <button 
          class="filter-btn" 
          [class.active]="categoriaSeleccionada === null"
          (click)="filtrarPorCategoria(null)">
          Todos
        </button>
        <button 
          *ngFor="let categoria of categorias"
          class="filter-btn" 
          [class.active]="categoriaSeleccionada === categoria.id_categoria"
          (click)="filtrarPorCategoria(categoria.id_categoria)">
          {{ categoria.nombre }}
          <span class="badge-count" *ngIf="categoria.total_obras">({{ categoria.total_obras }})</span>
        </button>
      </div>

      <div class="price-range">
        <span>Rango de precio:</span>
        <select class="price-select" (change)="filtrarPorPrecio($event)">
          <option value="">Todos los precios</option>
          <option value="0-1000">$0 - $1,000</option>
          <option value="1000-3000">$1,000 - $3,000</option>
          <option value="3000+">$3,000+</option>
        </select>
        <span class="results-count" *ngIf="totalObras > 0">
          {{ totalObras }} {{ totalObras === 1 ? 'obra' : 'obras' }}
        </span>
      </div>
    </section>


      <!-- Estado de carga -->
      <div *ngIf="cargandoObras" class="loading-state">
        <div class="spinner"></div>
        <p>Cargando obras...</p>
      </div>

      <!-- Error -->
      <div *ngIf="errorCarga" class="error-state">
        <p>{{ errorCarga }}</p>
        <button class="btn-retry" (click)="cargarObras()">Reintentar</button>
      </div>

      <!-- Grid de obras -->
      <div class="art-grid" *ngIf="!cargandoObras && !errorCarga">
        <div class="art-card" *ngFor="let obra of obras">
          <div class="art-badge disponible">Disponible</div>
          <div 
            class="art-image" 
            [style.background-image]="'url(' + obra.imagen_principal + ')'"
            [style.background-size]="'cover'"
            [style.background-position]="'center'">
          </div>
          <div class="art-info">
            <span class="art-category">{{ obra.categoria_nombre }}</span>
            <h3 class="art-title">{{ obra.titulo }}</h3>
            <p class="art-artist">Por {{ obra.artista_alias || obra.artista }}</p>
            <div class="art-footer">
              <span class="art-price">${{ obra.precio_minimo | number:'1.2-2' }}</span>
              <button class="btn-add-cart" (click)="agregarAlCarrito(obra)">
                Agregar al carrito
              </button>
            </div>
          </div>
        </div>

        <div *ngIf="obras.length === 0" class="no-results">
          <p>No se encontraron obras con los filtros seleccionados</p>
          <button class="btn-clear-filters" (click)="filtrarPorCategoria(null)">
            Limpiar filtros
          </button>
        </div>
      </div>

      <!-- Paginaci√≥n -->
      <div class="pagination" *ngIf="totalPaginas > 1 && !cargandoObras">
        <button 
          class="btn-page" 
          [disabled]="paginaActual === 1"
          (click)="cambiarPagina(paginaActual - 1)">
          ‚Üê Anterior
        </button>
        <span class="page-info">
          P√°gina {{ paginaActual }} de {{ totalPaginas }}
        </span>
        <button 
          class="btn-page" 
          [disabled]="paginaActual === totalPaginas"
          (click)="cambiarPagina(paginaActual + 1)">
          Siguiente ‚Üí
        </button>
      </div>
    </section>
  </main>

  <!-- ============================================
       VISTA: SEGURIDAD
       ============================================ -->
  <main class="content" *ngIf="vistaActual === 'seguridad'">
    <section class="hero-banner small">
      <div class="hero-content">
        <h1 class="hero-title">üîí Configuraci√≥n de Seguridad</h1>
        <p class="hero-subtitle">Elige c√≥mo deseas proteger tu cuenta</p>
      </div>
    </section>

    <div class="section-header">
      <h2>Autenticaci√≥n de Dos Factores</h2>
      <p>Elige un m√©todo de autenticaci√≥n adicional</p>
    </div>

    <div class="security-grid">
      <div class="security-card" (click)="configurar2FA()">
        <div class="security-icon">üì±</div>
        <h3>Aplicaci√≥n Autenticadora</h3>
        <p>Google Authenticator, Authy, etc.</p>
        <span class="security-badge recommended">Recomendado</span>
        <button class="btn-configure">Configurar</button>
      </div>

      <div class="security-card" (click)="configurarEmail2FA()">
        <div class="security-icon">üìß</div>
        <h3>Correo Electr√≥nico</h3>
        <p>C√≥digo enviado a tu email</p>
        <span 
          class="security-badge" 
          [ngClass]="{
            'active': usuario?.metodo_gmail_2fa,
            'disabled': !usuario?.metodo_gmail_2fa
          }">
          {{ usuario?.metodo_gmail_2fa ? 'Activo' : 'Disponible' }}
        </span>
        <button class="btn-configure">Configurar</button>
      </div>

      <div class="security-card" (click)="cerrarOtrasSesiones()">
        <div class="security-icon">üî•</div>
        <h3>Cerrar otras sesiones</h3>
        <p>Cierra todas las sesiones activas excepto esta</p>
        <span class="security-badge">Seguridad</span>
        <button class="btn-configure">Cerrar sesiones</button>
      </div>

      <div class="security-card">
        <div class="security-icon">‚è≠Ô∏è</div>
        <h3>Omitir por ahora</h3>
        <p>Puedes configurarlo despu√©s</p>
        <span class="security-badge">Opcional</span>
        <button class="btn-configure secondary" (click)="cambiarVista('inicio')">Volver</button>
      </div>
    </div>
  </main>

  <!-- ============================================
     FOOTER MEJORADO CON ESTRUCTURA PROFESIONAL
     ============================================ -->
  <footer class="footer">
  <div class="footer-content">
    <div class="footer-brand">
      <h3>NU‚òÖB STUDIO</h3>
      <p>Galer√≠a de arte regional de la Huasteca Hidalguense</p>
    </div>

    <nav class="footer-links">
      <a routerLink="/dashboard" class="footer-link">Galer√≠a</a>
      <span class="footer-separator"> ‚Ä¢ </span>
      <a routerLink="/about-us" class="footer-link">Nosotros</a>
      <span class="footer-separator"> ‚Ä¢ </span>
      <a routerLink="/faq" class="footer-link">Ayuda</a>
      <span class="footer-separator"> ‚Ä¢ </span>
      <a routerLink="/obra/nueva" class="footer-link">+ Agregar Obra</a>
      <span class="footer-separator"> ‚Ä¢ </span>
      <a (click)="testError(404)" class="footer-link dev" style="cursor: pointer;">404</a>
      <span class="footer-separator"> ‚Ä¢ </span>
      <a (click)="testError(403)" class="footer-link dev" style="cursor: pointer;">403</a>
      <span class="footer-separator"> ‚Ä¢ </span>
      <a (click)="testError(500)" class="footer-link dev" style="cursor: pointer;">500</a>
    </nav>
  </div>

  <div class="footer-copyright">
    <p>¬© 2025 NU‚òÖB STUDIO ‚Äî Hecho con ‚ù§Ô∏è en Huejutla, Hidalgo</p>
  </div>
</footer>
</div>